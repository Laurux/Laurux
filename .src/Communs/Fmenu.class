' Gambas class file

'----------------------------------------------------------------------------
'

'
'Ce programme est un logiciel libre; Vous pouvez le redistribuer et/ou
'le modifier selon les termes de la GNU General PUBLIC License publiés par
'la Free Software Foundation.
'Ce programme est distribué sans garantie. Voyez la GNU General PUBLIC
'License pour plus de details

'Vous devez lire la GNU General PUBLIC Licence.
'Si vous ne disposez pas d'un exemplaire, veuillez écrire
'à " The Free Software Foundation
'INC, 59 Temple place - Suite 33, Boston
'MA 02111-1307 USA..
'----------------------------------------------------------------------------
'################################################
'# nom du fichier           : FMenu.class
'# Auteur                   : Jacky Tripoteau
'# date de création         : 01/11/2004
'# Menu général de Laurux avec facturation
'################################################
'#######################################################
'# Modification Marc GUILLAUME <alarch@alarch.ath.cx>
'# pour utilisation d'un tunnel ssh de connexion MySQL
'# 07 janvier 2010
'########################################################
'
Public Soc As String
Public intitule As String
Public Version As String
Public PsX As Integer
Public PsY As Integer
Public CpTable[5] As String
Private Btunnel As Boolean = True
Private $mopt As Menuopt

Public Sub _new()

  Dim WidthME As String
  Dim spl As New String[2]

  If Start.LocalSettings["/Soc" & Start.Societe & "/Tme"] Then
    WidthME = Trim(Start.LocalSettings["/Soc" & Start.Societe & "/Ecran"])
    spl = Scan(WidthME, "*;*")
    Try Me.Width = Trim(spl[0])
    Try Me.height = Trim(spl[1])
  Endif
  Utils.Observers(Me)
  Me.Center

End

Public Sub Form_Open()

  Dim Exprt As String
  Dim Btq As String
  Dim Mat As String
  Dim Cai As String
  Dim $con_ok As Boolean = True ' flag d'autorisation de connexion
  Dim promo As Boolean
  Dim cpromo, lpromo As String
  Dim rResult As Result
  Dim Tab As String = "Fiches_Societes"
  Dim Chemin As String = "Fonds_Laurux/"
  Dim Pr As Prefs

  Tab = "Fiches_Parametres"
  Try Soc = Start.Societe
  Try intitule = Start.LocalSettings["/intitule"]
  If Start.LocalSettings["/Soc" & Start.Societe & "/Exp"] = True Then Exprt = "1"
  Menushowhide(Exprt)
  If Start.LocalSettings["/Soc" & Start.Societe & "/Btq"] = True Then Btq = "1"
  Menu2showhide(Btq)
  If Start.LocalSettings["/Soc" & Start.Societe & "/Materiel"] = True Then Mat = "1"
  Menu3showhide(Mat)
  If Start.LocalSettings["/Soc" & Start.Societe & "/Caisse"] = True Then Cai = "1"
  Menu4showhide(Cai)
  If Not Start.LocalSettings["/Soc" & Start.Societe & "/Taches"] Then Menu50.Visible = False
  'If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] = True Then Menu150.Visible = False
  If Start.LocalSettings["/Soc" & Start.Societe & "/Blocsoc"] = True Then
    Menu26.Visible = False
    'Menu65.visible = False
    'Menu166.visible = False
  Endif
  If Not Start.LocalSettings["/Soc" & Start.Societe & "/Lcr"] Then 
    MenuLcr.Visible = False
    MenuTbq.Visible = False
  Endif
  $mopt = New Menuopt(menu69, menu35, menu77, menu306)
  If Not IsNull(Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"]) Then
    If Exist(Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"]) Then
      PictureBox1.Picture = picture[Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"]]
    Endif
  Endif
  If Start.LocalSettings["/Soc" & Start.Societe & "/Slide"] Then
    Select Case Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"]
      Case chemin & "Laurux1.jpg"
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = chemin & "Laurux2.jpg"
      Case chemin & "Laurux2.jpg"
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = chemin & "Laurux3.jpg"
      Case chemin & "Laurux3.jpg"
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = chemin & "Laurux4.jpg"
      Case chemin & "Laurux4.jpg"
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = chemin & "Laurux5.jpg"
      Case chemin & "Laurux5.jpg"
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = ""
      Case Null
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = chemin & "Laurux1.jpg"
      Case Else
        Start.LocalSettings["/Soc" & Start.Societe & "/Fecran"] = ""
    End Select
  Endif
  If Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"] = False Then
    Menu287.Visible = False
  Else
    Menu287.Visible = True
  Endif
  If Start.LocalSettings["/Soc" & Start.Societe & "/Faca"] = 0 Then Menu299.visible = False
  If Start.LocalSettings["/Soc" & Start.Societe & "/Sms"] = 0 Then
    Menu315.visible = False
    Menu316.visible = False
  Endif
  
  If Error Then
    Select Case Message.Warning("Attention, le fichier de configuration n'existe pas ou est incorrect!\n Veuillez completer les informations suivantes!", "Initialisation Config SQL", "Réinitialisation Péférences", "Quitter")
      Case 1
        Config()
      Case 2
        preferences()
      Case Else
        Start.NoTips = True
        Me.Close()
    End Select
  Endif
  '# -- initialisation des informations SQL
  '* MG - 07 janvier 2010
  Utils.glb()

  '# -- montage éventuel du tunnel ssh
  '* MG - 07 janvier 2010
  If Start.LocalSettings["/dbase/Con-ssh"] Then
    If Not Utils.monteTunnel() Then
      $con_ok = False
    Endif
  Endif
  If $con_ok Then
    Try Utils.db.Open
    'function de restauration a partir de la ligne de commande
    'a n'utiliser que pour des tests
    Start.Restore_Args()
    
    Try Utils.db.exec("SET NAMES 'latin1'")
    If Not IsNull(Utils.db.Login) Then Shell "mysql -h " & Start.LocalSettings["/dbase/Host"] & " " & " -u " & Utils.db.Login & " -p" & Utils.db.Password & " -e \"use " & Utils.db.Name & ";" & "SET @@global.sql_mode=NO_ENGINE_SUBSTITUTION " & "; \"" Wait
    rResult = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabSoc") & " where cd_sc = &1", Soc)
    If rResult.Available Then Soc = Soc & " " & rResult!type_sc & " - " & rResult!int_sc
    Me.text = "Société en cours : " & Soc

    If Application.Path = "/usr/bin/" & Application.Name Then
      Menu173.Visible = False
    Else
      Majversion.RecupVersion()
    Endif
    LauruxMaj.Verif_Version()
    
    'lit les préférences locales puis surcharge par les globales si elles existent
    Pr = New Prefs(Start.LocalSettings)
    Start.GlobalSettings = Pr.ReadGlobal()
    Pr.ApplyGlobal(Start.GlobalSettings)
    
    If Start.LocalSettings["/Soc" & Start.Societe & "/Infob"] Then Application.ShowTooltips = False
    If Start.LocalSettings["/Soc" & Start.Societe & "/Cnomade"] Then
      Menu300.Visible = True
    Else
      Menu300.Visible = False
    Endif

    SetObserver(ScrollView1)
    Try rResult = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabPromo") & " where datedeb = &1", Format$(Now, "yyyy-mm-dd"))
    If Not Error Then
      If rResult.Available Then
        Promo = True
        Cpromo = rResult!code
        Lpromo = rResult!libelle
      Endif
      If Promo = True Then
        Syntheses.Message("La promotion " & Cpromo & ", " & Lpromo & ", débute aujourd'hui . Pensez aux impressions d' étiquettes de début de promotion")
        Message.Info("Rappel: La promotion " & Cpromo & " " & Lpromo & " débute aujourd'hui !\n Pensez aux impressions d' étiquettes de début de promotion")
      Endif
      Promo = False
      rResult = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabPromo") & " where datefin = &1", Format$(Now, "yyyy-mm-dd"))
      If rResult.Available Then
        Promo = True
        Cpromo = rResult!code
        Lpromo = rResult!libelle
      Endif
      If Promo = True Then
        Syntheses.Message("La promotion " & Cpromo & ", " & Lpromo & ", se termine aujourd'hui ! Pensez aux impressions d'étiquettes de fin de promotion.")
        Message.Info("Rappel: La promotion " & Cpromo & " " & Lpromo & " se termine aujourd'hui !\nPensez aux impressions d'étiquettes de fin de promotion.")
      Endif
      promo = False
      If Start.LocalSettings["/Soc" & Start.Societe & "/Faca"] Then Abonnement()
      If Start.son Then
        Music.Load("son/menu.ogg")
        Music.Play
      Endif
    Endif
  Else
    Message.Warning("Le tunnel SSH n'a pu être établi, la connexion SQL est impossible")
    Config()
  Endif
  If Start.LocalSettings["/Soc" & Start.Societe & "/Taches"] Then
    Label3.Text = "Bonjour " & User.name & " nous sommes le " & Format(Now, "dd.mm.yyyy")
    ColTaches.Columns.count = 5
    ColTaches.Columns[0].Width = 0
    ColTaches.Columns[1].Width = 100
    ColTaches.Columns[2].Width = 180
    ColTaches.Columns[3].Width = 180
    ColTaches.Columns[1].Text = "Documents"
    ColTaches.Columns[2].Text = "Utilisateur"
    ColTaches.Columns[3].Text = "Poste"
    ColTaches.Columns[4].Text = "Libellé de la tâche"
    RecupTaches()
  Endif

Catch
  If Error.text = "Connection is not opened" Then
    Message.Warning("Attention, la base Laurux " & Start.Societe & " n 'existe pas !\n Veuillez remplir le fichier de configuration SVP !")
  Else
    If Left$(error.Text, 19) = "Driver name missing" Then
      Message.Warning("Attention, le fichier de configuration n'existe pas ! \n Veuillez completer les zones nécéssaires à sa création SVP !")
    Else
      If Left$(error.Text, 13) = "type mismatch" Then
        Message.Warning("Attention, le fichier de configuration n'existe pas ou est corrompu !")
      Else
        If Left$(error.Text, 27) = "Cannot open database: Acces" Then
          Message.Warning("Attention, l' utilisateur ou le mot de passe est erroné ! \n Veuillez controler votre saisie SVP !")
        Else
          If Left$(error.Text, 38) = "Cannot open database: Unknown database" Then
            Message.Warning("Attention, la base Laurux " & Start.Societe & " n 'existe pas !\n Veuillez remplir le fichier de configuration SVP !")
          Else
            message.Error(Error.Text & " " & Error.Where)
          Endif
        Endif
      Endif
    Endif
  Endif
  
  Select Case Message.Question("Attention, Une erreur important à eu lieu au démarrage de l'application\nLe fichier de configuration est probablement incorrect!\n", "Config SQL", "Réinitialisation Péférences", "Restaurer une sauvegarde")
      Case 1
        Config()
      Case 2
        preferences()
      Case Else
        FRestore.showModal()
    End Select
  
  Message.Warning(Application.Name & " va maintenant quitter! Merci de le relancer.")
  Start.NoTips = True
  Me.Close()
  
End

Public Sub RecupTaches()

  Dim itaches As Integer = 0

  With Coltaches
    .Columns.count = 5
    .Columns[0].Width = 0
    .Columns[1].Width = 90
    .Columns[2].Width = 100
    .Columns[3].Width = 180
    .Columns[4].Width = 300
  End With
  Utils.Base(Coltaches, "select * from  Fiches_Taches  where nom like   \"" & User.name & "%\" ")
  Coltaches.Refresh
  itaches = Coltaches.rows.count
  If itaches > 1 Then Panel2.Visible = True

End

Public Sub Coltaches_Data(Row As Integer, Column As Integer)

  With Utils
    CpTable[0] = "lind"
    CpTable[1] = "numdoc"
    CpTable[2] = "nom"
    CpTable[3] = "poste"
    CpTable[4] = "texte"
    Try .rs1.MoveTo(Row)
    Try Coltaches.data.Text = Str(.rs1[CpTable[Column]])
  End With

End

Public Sub ColTaches_KeyPress()

  If Start.son Then
    Music.Play
  Endif
  If Message.Question("Etes vous sur de vouloir effacer cet enregistrement", "Oui", "Non") = 1 Then
    Utils.db.Exec("DELETE  FROM Fiches_Taches WHERE lind = &1", Coltaches[Coltaches.row, 0].Text)
    Utils.db.Exec("ALTER TABLE Fiches_Taches ORDER BY lind")
    RecupTaches()
  Endif

End

Public Sub Timer1_Timer()

  AffRdv.Calc_Timer(Timer1)

End

Public Sub Abonnement()

  Dim DteN, DteN2, dateAb, dateAb2, Aban, DteFac, Code As String
  Dim rClient As Result
  Dim impok As Boolean = False
  Dim nb As Integer = 0

  dteN = Format$(Now, "yyyymmdd")
  DteN2 = Format$(Now, "dd.mm.yyyy")
  'rClient = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabBl") & " Left join " & Cbase.Table("TabCli") & " on cli_code = cdclibl where type = &1 and totalht <> &2 and dtefac <= &3 order by cdclibl asc, dtefac desc", "A", 0, Utils.cdate_dbase(dteN2))
  rClient = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabBl") & " Left join " & Cbase.Table("TabCli") & " on cli_code = cdclibl where type = &1 and totalht <> &2 and dtefac <= &3 or type = &1 and totalht <> &2 and isnull(dtefac) order by cdclibl asc, dtefac desc", "A", 0, Utils.cdate_dbase(dteN2))
  If rClient.Available Then
    'code = rClient!cdclibl
    Repeat
      dateAb = rClient!cli_datab
      Aban = rClient!cli_aban
      DteFac = rClient!dtefac
      If code <> rClient!cdclibl Then
        If Not IsNull(DteFac) Then
          Select Case Aban
            Case "1- Mensuel"
              dateAb2 = (Val(Format$(Now, "mm")) - 1)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN2, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "2- Bimensuel"
              dateAb2 = (Val(Mid$(dteN, 5, 2)) - 2)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN2, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "3- Trimestriel"
              dateAb2 = (Val(Mid$(dteN, 5, 2)) - 3)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN2, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "4- Semestriel"
              dateAb2 = (Val(Mid$(dteN, 5, 2)) - 6)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN2, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "5- Annuel"
              dateAb2 = (Val(Format$(Now, "yyyy")) - 1)
              If Val(Right$(DteFac, 4)) <= Val(dateAb2) Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Right$(dteN2, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
          End Select
        Else
          impok = True
          Inc nb
        Endif
      Endif
      code = rClient!cdclibl
    Until rClient.MoveNext()
    If impok = True Then
      Syntheses.Message("Aujourd'hui, il y a " & nb & " factures périodiques a éditer.")
      Message.Info("Aujourd'hui, il y a " & nb & " facture(s) périodique(s) a imprimer!")
    Endif
  Endif

End

Public Sub preferences()

  Dim $ipr As New Integer[]

  Start.LocalSettings["/son"] = 0
  Start.LocalSettings["/Tips"] = 1
  Start.LocalSettings["/Soc" & Start.Societe & "/Entete"] = 1
  Start.LocalSettings["/Soc" & Start.Societe & "/Conditions"] = 1
  Start.LocalSettings["/Soc" & Start.Societe & "/Tva550"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Codetva"] = " "
  Start.LocalSettings["/Soc" & Start.Societe & "/Compta"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Gestion"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/CptFac"] = 1
  Start.LocalSettings["/Soc" & Start.Societe & "/Qt1"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Coul_fen"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Qt1"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Ctrlstk"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/AutoEnt"] = 0
  Start.LocalSettings["/Coul" & "/Fnets"] = "Background: &HDDDDDD&; "
  Start.LocalSettings["/Coul" & "/Btns"] = "Background: &HBDBDBD&; "
  Start.LocalSettings["/Coul" & "/Znss"] = "Background: &HFAFAFA&; "
  Start.LocalSettings["/Coul" & "/Znaff"] = "Background: &HEEEEEE&; "
  Start.LocalSettings["/Coul" & "/Focus"] = "Background: &HF9FFC7&; "
  Start.LocalSettings["/Coul" & "/Coulfonds"] = "Background: &FFEE81&; "
  Start.LocalSettings["/Coul" & "/Others"] = "Background: &FFE0B8&; "
  Start.LocalSettings["/Coul" & "/Fcs"] = "Background: &HF9FFC7&"
  Start.LocalSettings["/Coul" & "/Stk"] = "Background: &HCFF58E&; Font: serif,9; "
  Start.LocalSettings["/Coul" & "/Coulfonds"] = "255,252,216,"
  Start.LocalSettings["/Coul" & "/Others"] = "255,232,199,"
  Start.LocalSettings["/Coul" & "/Facts"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Avs"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Bl"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Devis"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Cmde"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Prf"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Nstk"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Eps"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Coul" & "/Spd"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Start.LocalSettings["/Soc" & Start.Societe & "/Font"] = "Serif,+1"
  Start.LocalSettings["/Soc" & Start.Societe & "/Copie"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Siret"] = "Siret"
  Start.LocalSettings["/Soc" & Start.Societe & "/Prxdec"] = 0
  Start.LocalSettings["/Soc" & Start.Societe & "/Slide"] = 1
  Start.LocalSettings["/Soc" & Start.Societe & "/Taxe"] = "TVA"
  Start.LocalSettings["/Soc" & Start.Societe & "/nbfam"] = "5"
  $ipr.Add(5)
  Start.LocalSettings["/Soc" & Start.Societe & "/ipr"] = $ipr
  Start.LocalSettings["/Soc" & Start.Societe & "/pp"] = False
  Start.LocalSettings["/Soc" & Start.Societe & "/bois"] = False
  Start.LocalSettings.Save
  Start.LocalSettings.Reload

End

Public Sub Menushowhide(Exprt As String) As String

  If Exprt = "1" Then
    Menu133.Visible = True
    Menu134.Visible = False
  Else
    Menu133.Visible = False
    Menu134.Visible = True
  Endif

End

Public Sub Menu2showhide(Btq As String) As String

  If Btq = "1" Then
    Menu184.Visible = True
    Menu183.Visible = True
  Else
    Menu184.Visible = False
    Menu183.Visible = False
  Endif

End

Public Sub Menu3showhide(Mat As String) As String

  If Mat = "1" Then
    Menu190.Visible = True
    Menu193.Visible = True
    HBox17.Visible = True
    HBox18.Visible = True
  Else
    Menu190.Visible = False
    Menu193.Visible = False
    HBox17.Visible = False
    HBox18.Visible = False
  Endif

End

Public Sub Menu4showhide(Cai As String) As String

  If Cai = "1" Then
    Menu203.Visible = True
    Menu296.Visible = True
  Else
    Menu203.Visible = False
    Menu296.Visible = False
  Endif

End

Public Sub Config()

  LauruxConf.ShowModal()
  Soc = Start.Societe

End

Public Sub Menu114_Click()

  Fcomptes.Show

End

Public Sub Menu112_Click()

  FTvav.Show

End

Public Sub Menu113_Click()

  FTvac.show

End

Public Sub Menu111_Click()

  Fcollectif.show

End

Public Sub Menu115_Click()

  Fjournaux.show

End

Public Sub Menu12_Click()

  FClient.ShowModal()

End

Public Sub Menu13_Click()

  Ffournisseur.ShowModal()

End

Public Sub Client_Click()

  menu12_Click()

End

Public Sub fournisseur_Click()

  Menu13_Click()

End

Public Sub compte_Click()

  Menu114_Click()

End

Public Sub Tva_Click()

  Menu113_Click()

End

Public Sub Tvac_Click()

  Menu113_Click()

End

Public Sub libellesaisies_Click()

  Menu24_Click()

End

Public Sub journaux_Click()

  Menu115_Click()

End

Public Sub collectif_Click()

  Menu111_Click()

End

Public Sub Menu15_Click()

  Articles.Show()

End


Public Sub Menu26_Click()

  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Fsoc.Show
      Start.Motdepasse = ""
    Endif
  Else
    Fsoc.Show
  Endif

End

Public Sub Menu21_Click()

  Dim hForm As Saisecrit

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie d'écriture impossible.")
      Return
    Endif
  Endif

  hForm = New Saisecrit("")
  hForm.Show()

End

Public Sub Menu22_Click()

  Dim hForm As Tresor

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie d'écriture impossible.")
      Return
    Endif
  Endif

  hForm = New Tresor("")
  hForm.Showmodal()

End

Public Sub Menu24_Click()

  Flibelle.Show

End

Public Sub Menu25_Click()

  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Parametre.Showmodal()
      Start.Motdepasse = ""
    Endif
  Else
    Parametre.Showmodal()
  Endif

End

Public Sub Menu38_Click()

  Editcompte.Show

End

Public Sub Menu51_Click()

  Dim hForm As Lettrage

  hForm = New Lettrage("", "")
  hForm.Showmodal()

End

Public Sub Menu61_Click()

  Pointage.Show

End

Public Sub Menu16_Click()

  Dim hForm As Extrait

  hForm = New Extrait("", "", "", "")
  hForm.Showmodal()
  'Extrait.Show(" ", " ", " ", " ")

End

Public Sub Menu23_Click()

  Fabout.Show

End

Public Sub Menu31_Click()

  Balance.Show

End

Public Sub Menu32_Click()

  journaux.Show

End

Public Sub ToolButton1_Click()

  Shell "rm " & User.home & "/tmp/*"
  Me.Persistent = False
  Me.close

End

Public Sub Menu46_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Clôture impossible.")
      Return
    Endif
  Endif

  FCloture.ShowModal()

End

Public Sub Menu27_Click()

  Frelance.Show

End

Public Sub Menu49_Click()

  FEditrel.Show

End

Public Sub Menu50_Click()

  Fusers.Show

End

Public Sub Menu30_Click()

  FRelcompte.Show

End

Public Sub Menu52_Click()

  FRelFacture.Show

End

Public Sub Menu40_Click()

  Fmontant.Show

End

Public Sub Menu54_Click()

  EdFam.Show

End

Public Sub Menu57_Click()

  FSauve.Show()

End

Public Sub Menu59_Click()

  Edmo.Show

End

Public Sub Menu65_Click()

  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      FRestore.ShowModal()
      Start.Motdepasse = ""
    Endif
  Else
    FRestore.ShowModal()
  Endif

End

Public Sub Menu60_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Clôture impossible.")
      Return
    Endif
  Endif

  FClotureAn.Show()

End

Public Sub Menu73_Click()

  EdArt1.Show

End

Public Sub Menu74_Click()

  EdArt4.Show

End

Public Sub Achat_Click()

  Menu21_Click

End

Public Sub Menu14_Click()

  Famille.Show

End

Public Sub Menu70_Click()

  Plancomptable.Show

End

Public Sub Menu17_Click()

  Comment.Show

End

Public Sub Menu28_Click()

  Txmo.Show

End

Public Sub Article_Click()

  Menu15_Click()

End

Public Sub Menu10_Click()

  Ecritures.Show

End

Public Sub Menu37_Click()

  Movr.ShowModal()

End

Public Sub Moeuvre_Click()

  Menu37_Click()

End

Public Sub Menu42_Click()

  Dim hForm As Facture
  Dim hForm2 As ConVendeurs

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  hForm = New Facture(False)
  If Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"] <> 0 And Not IsNull(Start.LocalSettings["/Soc" & Start.Societe & "/CodeVendeur"]) Then
    hForm.ShowModal()
  Else
    If Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"] = 0 Or If IsNull(Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"]) Then
      hForm.ShowModal()
    Else
      hForm2 = New ConVendeurs
      hForm2.ShowModal()
    Endif
  Endif
  Stop Event

End

Public Sub ToolButton2_Click()

  Menu42_Click()

End

Public Sub Menu72_Click()

  Archives.ShowModal()

End

Public Sub Tvav_Click()

  Menu112_Click()

End

Public Sub Menu76_Click()

  Calcsolde.ShowModal()

End

Public Sub ToolButton3_Click()

  Menu61_Click()

End

Public Sub ToolButton4_Click()

  Menu10_Click()

End

Public Sub ToolButton5_Click()

  Menu40_Click()

End

Public Sub Menu78_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif
  Receipt.showModal()

End

Public Sub Blm_Click()

  Menu78_Click()

End

Public Sub Menu79_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  Mvtex.showModal()

End

Public Sub Mvt_Click()

  Menu79_Click()

End

Public Sub Menu88_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  Commande.showModal()

End

Public Sub com_Click()

  Menu88_Click()

End

Public Sub Menu89_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  Receipta.showModal()

End

Public Sub Bla_Click()

  Menu89_Click()

End

Public Sub Menu90_Click()

  Edbl.Show

End

Public Sub Menu91_Click()

  Edregul.Show

End

Public Sub Menu92_Click()

  Edcom.Show

End

Public Sub Menu81_Click()

  Geninv.Show

End

Public Sub Menu82_Click()

  Saisieinv.Show

End

Public Sub Menu84_Click()

  Validinv.Show

End

Public Sub Menu83_Click()

  Ecarts.Show

End

Public Sub Menu85_Click()

  Dim ed As New Edinv("F")
  
  
  Ed.Show

End

Public Sub Menu93_Click()

  Ednsaisis.Show

End

Public Sub Menu95_Click()

  GeninvT.Showmodal()

End

Public Sub Menu96_Click()

  SaisieinvT.Show

End

Public Sub Menu97_Click()

  EdnsaisisT.Show

End

Public Sub Menu98_Click()

  EcartsT.Show

End

Public Sub Menu99_Click()

  Dim ed As New Edinv("T")
  
  Ed.Show

End

Public Sub Menu100_Click()

  ValidinvT.Show

End

Public Sub Menu102_Click()

  EdStk.Show

End

Public Sub Menu103_Click()

  EdNlettrees.Show

End

Public Sub Menu104_Click()

  EDfour.Show

End

Public Sub Menu105_Click()

  Hit.Show

End

Public Sub Menu106_Click()

  EdNlettrees.Show

End

Public Sub Menu107_Click()

  StatFam.Show

End

Public Sub Menu110_Click()

  Dim Pr As Prefs

  Pr = New Prefs(Start.LocalSettings)
  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Start.Motdepasse = ""
      Pr.ShowModal()
    Endif
  Else
    Pr.ShowModal()
  Endif

End

Public Sub Menu329_Click()

  Dim Pr, Prl As Prefs
  Dim mp As MDP

  Pr = New Prefs(Start.GlobalSettings, Null, True)
  Start.GlobalSettings = Pr.ReadSettings()
  If (Not IsNull(Start.GlobalSettings))
    If Start.GlobalSettings["/Soc" & Start.Societe & "/AdminG"] Then
      mp = New MDP(Null, True)
      mp.showmodal()
      If Start.Motdepasse = "OK" Then
        Start.Motdepasse = ""
        Pr.ShowModal()
      Endif
    Else
      Pr.ShowModal()
    Endif
   'rejoue new globals sur local
    Prl = New Prefs(Start.LocalSettings)
    Prl.ApplyGlobal(Prl.ReadGlobal())
  Endif
End

Public Sub Menu109_Click()

  jourcent.Show

End

Public Sub Menu201_Click()

  StatClimo.Show

End

Public Sub Menu116_Click()

  StatCli.Show

End

Public Sub Menu117_Click()

  StatClimo.Show

End

Public Sub Menu118_Click()

  Me.close

End

Public Sub Menu121_Click()

  Me.close

End

Public Sub form_close()

  Start.UnLock()
  Start.LocalSettings["/Soc" & Start.Societe & "/Ecran"] = Me.Width & ";" & Me.Height
  If Start.LocalSettings["/Soc" & Start.Societe & "/Sauvauto"] And If Start.LocalSettings["/dbase/Maj"] Then SauvesAuto.Sauvegarde(Me)
  If Start.son Then
    Music.Load("son/fermeture-menu.ogg")
    Music.Play
    Wait 1.5
  Endif
  Utils.fermeTunnel()
  Utils.db.Close()

End

Public Sub Tsr_Click()

  Menu22_Click

End

Public Sub Menu122_Click()

  Rubresult.Show

End

Public Sub Menu123_Click()

  Rubcompt.Show

End

Public Sub Menu124_Click()

  RubImp.Show

End

Public Sub journal_Click()

  Fjournaux.Show

End

Public Sub Menu101_Click()

  EdClient.Show

End

Public Sub Menu108_Click()

  EDfour.Show

End

Public Sub Menu125_Click()

  Ftips.run

End

Public Sub Menu126_Click()

  Lettragemontant.show

End

Public Sub Menu127_Click()

  Lettragesoldes.show

End

Public Sub Menu128_Click()

  Trecarts.Show

End

Public Sub ToolButton6_Click()

  Menu16_Click()

End

Public Sub ToolButton7_Click()

  Menu51_click()

End

Public Sub Menu130_Click()

  LibelFac.Show

End

Public Sub Menu131_Click()

  echeances.ShowModal

End

Public Sub Menu132_Click()

  Verbal.ShowModal

End

Public Sub Menu133_Click()

  ExportJdv.ShowModal

End

Public Sub Menu134_Click()

  ImpJdv.ShowModal

End

Public Sub Menu141_Click()

  Prgm.Show

End

Public Sub Menu138_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Facturation fin de mois impossible.")
      Return
    Endif
  Endif

  Facturefm.ShowModal

End

Public Sub Menu142_Click()

  Histovart.Show

End

Public Sub Menu143_Click()

  Histovmo.Show

End

Public Sub Menu145_Click()

  Changefam.ShowModal

End

Public Sub Menu147_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Clôture impossible.")
      Return
    Endif
  Endif

  ClotureF.ShowModal

End

Public Sub Menu150_Click()

  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Dup.showModal
      Start.Motdepasse = ""
    Endif
  Else
    Dup.showModal
  Endif

End

Public Sub Menu155_Click()

  StatCA.showModal

End

Public Sub Menu154_Click()

  Remisec.show

End

Public Sub Menu156_Click()

  Carch.show

End

Public Sub Menu149_Click()

  Typec.show

End

Public Sub SetObserver(hCont As Container)

  Dim hObs As Observer
  Dim o As Control

  For Each o In hCont.Children
    If o Is Label Then
      hobs = New Observer(o) As "OBS"
      o.Mouse = mouse.Pointing
    Endif
    If o Is Container Then SetObserver(o)
  Next

End

Public Sub OBS_Enter()

  Last.Foreground = Color.Blue
  Last.Font.Underline = True

End

Public Sub OBS_Leave()

  Last.Foreground = Color.ButtonForeground
  Last.Font.Underline = False

End

Public Sub lblCli_MouseDown()

  menu12_Click()
  Stop Event

End

Public Sub lblFour_MouseUp()

  Menu13_Click()
  Stop Event

End

Public Sub LblFam_MouseUp()

  Menu14_Click()
  Stop Event

End

Public Sub lblArt_MouseUp()

  Menu15_Click()
  Stop Event

End

Public Sub lblMO_MouseUp()

  Menu37_Click()
  Stop Event

End

Public Sub lblFac_MouseUp()

  Menu42_Click()
  Stop Event

End

Public Sub lblCom_MouseUp()

  Menu88_Click()
  Stop Event

End

Public Sub lblRcptM_MouseUp()

  Menu78_Click()
  Stop Event

End

Public Sub lblRcptA_MouseUp()

  Menu89_Click()
  Stop Event

End

Public Sub lblRgl_MouseUp()

  Menu79_Click()
  Stop Event

End

Public Sub lblVrecpt_MouseUp()

  Menu295_Click()
  Stop Event

End

Public Sub Menu153_Click()

  SetColors.ShowDialog

End

Public Sub lblRem_MouseUp()

  Menu154_Click()
  Stop Event

End

Public Sub lblArch_MouseDown()

  Archives.ShowModal()
  Stop Event

End

Public Sub lblFacfm_MouseDown()

  Facturefm.ShowModal
  Stop Event

End

Public Sub lblClm_MouseDown()

  ClotureF.ShowModal
  Stop Event

End

Public Sub lblClm2_MouseDown()

  ConsultArt.Show
  Stop Event

End

Public Sub Menu152_Click()

  Impclient.show

End

Public Sub Menu157_Click()

  Dim Myform As Etiqart

  MyForm = New Etiqart("")
  MyForm.Showmodal()

End

Public Sub Menu158_Click()

  Dim Myform As Etigond

  MyForm = New Etigond("")
  MyForm.Showmodal()

End

Public Sub Menu161_Click()

  Dim Myform As Etiqart

  MyForm = New Etiqart("")
  MyForm.Showmodal()

End

Public Sub Menu162_Click()

  Dim Myform As Etigond

  MyForm = New Etigond("")
  MyForm.Showmodal()

End

Public Sub Menu163_Click()

  Eticli.show

End

Public Sub Menu164_Click()

  EtiqRecpt.show

End

Public Sub Menu165_Click()

  Etiquettes.Show

End

Public Sub Menu166_Click()

  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      LauruxConf.Show
      Start.Motdepasse = ""
    Endif
  Else
    LauruxConf.Show
  Endif

End

Public Sub Menu168_Click()

  Calcstock.ShowModal

End

Public Sub Menu169_Click()

  StatFour.show

End

Public Sub Menu170_Click()

  Expclient.show

End

Public Sub Menu171_Click()

  Expbase.show

End

Public Sub Menu175_Click()

  Dim hForm As Emailing

  hForm = New Emailing("mail")
  hForm.Showmodal()
  Stop Event

End

Public Sub Menu173_Click()
  'maj version

  If Start.LocalSettings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Majversion.Show()
      Start.Motdepasse = ""
    Endif
  Else
    Majversion.Show()
  Endif

End

Public Sub Menu63_Click()

  Doc.Open("LauruxIndexParCategories")

End

Public Sub Menu64_Click()

  Exec ["xdg-open", "http://www.laurux.fr"]

End

Public Sub Menu176_Click()

  StatTypCli.Show

End

Public Sub Menu181_Click()

  Cielcorspj.ShowModal()

End

Public Sub Menu180_Click()

  Cielcorsp.ShowModal()

End

Public Sub Menu182_Click()

  Cielimp.ShowModal()

End

Public Sub Menu184_Click()

  Btqart.ShowModal()

End

Public Sub Menu186_Click()

  Impart.ShowModal()

End

Public Sub Menu189_Click()

  Cpostaux.Show()

End

Public Sub Menu190_Click()

  Dim hForm As Materiel

  hForm = New Materiel("")
  hForm.Showmodal()

End

Public Sub lblMat_MouseDown()

  Dim hForm As Materiel

  hForm = New Materiel("")
  hForm.Showmodal()
  Stop Event

End

Public Sub Menu191_Click()

  Marques.Show()

End

Public Sub Menu193_Click()

  Dim hForm As Facture
  Dim hForm2 As ConVendeurs

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  hForm = New Facture(True)
  If Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"] <> 0 And Not IsNull(Start.LocalSettings["/Soc" & Start.Societe & "/CodeVendeur"]) Then
    hForm.ShowModal()
  Else
    If Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"] = 0 Or If IsNull(Start.LocalSettings["/Soc" & Start.Societe & "/Vendeurs"]) Then
      hForm.ShowModal()
    Else
      hForm2 = New ConVendeurs(True)
      hForm2.ShowModal()
    Endif
  Endif
  Stop Event

End

Public Sub lblFac2_MouseDown()

  Menu193_Click()
  Stop Event

End

Public Sub Menu194_Click()

  Edpaiement.ShowModal()

End

Public Sub Menu195_Click()

  Identite.ShowModal()

End

Public Sub Menu196_Click()

  RelvMo.Show()

End

Public Sub Menu197_Click()

  RelMoprod.Show()

End

Public Sub Menu198_Click()

  Abont.show()

End

Public Sub Menu199_Click()

  Tleg.Show()

End

Public Sub Menu202_Click()

  Agenda.show

End

Public Sub Menu205_Click()

  Fcaisses.ShowModal()

End

Public Sub Menu207_Click()

  LibelTicket.ShowModal()

End

Public Sub Menu206_Click()

  Fvendeurs.ShowModal()

End

Public Sub Menu214_Click()

  Bordereaux.ShowModal()

End

Public Sub Menu208_Click()

  LibelAvoirs.ShowModal()

End

Public Sub Menu209_Click()

  Fclientc.ShowModal()

End

Public Sub Menu215_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie impossible.")
      Return
    Endif
  Endif

  Moulinage.ShowModal()

End

Public Sub Menu218_Click()

  ArchivesTck.ShowModal()

End

Public Sub Menu204_Click()

  Statcai.Showmodal()

End

Public Sub Menu219_Click()

  Statut.Show()

End

Public Sub Menu221_Click()

  Fpromo.ShowModal()

End

Public Sub Menu222_Click()

  FpromoArt.ShowModal()

End

Public Sub Menu223_Click()

  StatPromo.ShowModal()

End

Public Sub Menu225_Click()

  EtiqPromo.ShowModal()

End

Public Sub Menu226_Click()

  Remisecli.ShowModal()

End

Public Sub Menu227_Click()

  Prodcomposes.ShowModal()

End

Public Sub Menu229_Click()

  EpurMvtexp.ShowModal()

End

Public Sub Menu230_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  MvtProdcomp.ShowModal()

End

Public Sub Menu232_Click()

  RazInv.ShowModal()

End

Public Sub Menu233_Click()

  RazInvT.ShowModal()

End

Public Sub Menu234_Click()

  SupprArt.ShowModal()

End

Public Sub lblClm3_MouseDown()

  Fprepdus.show()
  Stop Event

End

Public Sub Menu238_Click()

  FClientcarte.ShowModal()

End

Public Sub Menu239_Click()

  HitCarte.ShowModal()

End

Public Sub Menu240_Click()

  EmailingCarte.ShowModal()

End

Public Sub Menu241_Click()

  Centrales.Show()

End

Public Sub Menu242_Click()

  Etiqfbtarif.ShowModal()

End

Public Sub Menu245_Click()

  ImpartParam.ShowModal()

End

Public Sub Menu246_Click()

  MajFbtarif2.Showmodal()

End

Public Sub Menu247_Click()

  Etiqfbtarif.ShowModal()

End

Public Sub Menu248_Click()

  MajTarifP.show()

End

Public Sub Menu249_Click()

  MajTarifM.Show()

End

Public Sub Menu250_Click()

  Statbase.ShowModal()

End

Public Sub Menu251_Click()

  TBord.Show()

End

Public Sub Menu252_Click()

  EdNjustifiees.Show()

End

Public Sub Menu253_Click()

  EdRup.Show()

End

Public Sub Menu254_Click()

  EdDocs.Show()

End

Public Sub Menu255_Click()

  Tmail.Show()

End

Public Sub Menu256_Click()

  Monip.Monip()

End

Public Sub Menu259_Click()

  RazHistoFac.ShowModal()

End

Public Sub Menu260_Click()

  RazHistoTk.ShowModal()

End

Public Sub Menu261_Click()

  RazHistoFbl.ShowModal()

End

Public Sub Menu262_Click()

  RazRlvb.ShowModal()

End

Public Sub Menu263_Click()

  FTVA.show()

End

Public Sub Menu265_Click()

  Traites.Show()

End

Public Sub Menu264_Click()

  Edregulprdc.Show()

End

Public Sub Menu266_Click()

  Fsystem.show

End

Public Sub Menu268_Click()

  Depots.Show()

End

Public Sub Menu269_Click()

  MvtDepots.Show()

End

Public Sub Menu270_Click()

  Sdepots.show()

End

Public Sub Menu272_Click()

  ImpDepots.show()

End

Public Sub Menu273_Click()

  Edsdepots.Show()

End

Public Sub Menu275_Click()

  Majcasier.Show()

End

Public Sub Menu277_Click()

  Variables.OrgTarCli = "Cli"
  TarCli.Show()

End

Public Sub Menu278_Click()

  Variables.OrgTarTypeCli = ""
  TarTypeCli.Show()

End

Public Sub Menu279_Click()

  RazArt.Show()

End

Public Sub Menu281_Click()

  Expart.Show()

End

Public Sub Menu282_Click()

  Prgm.show()

End

Public Sub Menu283_Click()

  Expcontact.Show()

End

Public Sub Menu284_Click()

  Impcpostaux.Show()

End

Public Sub Menu286_Click()

  ImpSage.ShowModal()

End

Public Sub Menu287_Click()

  Fvendeurs.Show()

End

Public Sub Menu288_Click()

  CoefTypeC.Show()

End

Public Sub Menu289_Click()

  EdMat.Show()

End

Public Sub Menu290_Click()

  RazDevis.ShowModal()

End

Public Sub Menu292_Click()

  JournauxA.ShowModal()

End

Public Sub Menu293_Click()

  EditcompteA.ShowModal()

End

Public Sub Menu294_Click()

  FPostes.show()

End

Public Sub Menu295_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  ValidBR.ShowModal()

End

Public Sub Menu296_Click()

  RazClientd.ShowModal()

End

Public Sub Menu297_Click()

  EdArt3.ShowModal()

End

Public Sub Menu298_Click()

  ExportA47.ShowModal()

End

Public Sub Menu299_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Facturation impossible.")
      Return
    Endif
  Endif

  FacturefmA.ShowModal()

End

Public Sub Menu300_Click()

  Fimport.ShowModal()

End

Public Sub Menu301_Click()

  If Start.LocalSettings["/dbase/Con-ssh"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Replique"] And If Start.LocalSettings["/Soc" & Start.Societe & "/Breplique"] Then
    Btunnel = Utils.ControlTunnel()
    If Not Btunnel Then
      Message.Error("Problème de réplication ! Saisie de document impossible.")
      Return
    Endif
  Endif

  ModifBR.showModal()

End

Public Sub Menu302_Click()

  Dim Myform As Etiqcasier

  MyForm = New Etiqcasier("")
  MyForm.Showmodal()

End

Public Sub Menu303_Click()

  Echeancier.ShowModal()

End

Public Sub Menu305_Click()

  Changefour.ShowModal()

End

Public Sub Menu306_Click()

  Facturergbl.ShowModal()

End

Public Sub Menu309_Click()

  Dim hForm As Gged

  hForm = New Gged("", "", "", "")
  hForm.Show()

End

Public Sub Menu310_Click()

  GedR.Show()

End

Public Sub Menu311_Click()

  RazClos.ShowModal()

End

Public Sub Menu312_Click()

  Commerciaux.Show()

End

Public Sub Menu313_Click()

  StatComm.Show()

End

Public Sub Menu314_Click()

  StatComArt.Show()

End

Public Sub Menu315_Click()

  Sms.Show()

End

Public Sub Menu319_Click()

  Dim hForm As Gsm

  hForm = New Gsm("")
  hForm.Showmodal()

End

Public Sub Menu318_Click()

  Histocliart.Show()

End

Public Sub Menu320_Click()

  Dim hForm As Emailing

  hForm = New Emailing("sms")
  hForm.Showmodal()
  Stop Event

End

Public Sub Menu321_Click()

  BordereauxC.showmodal()

End

Public Sub Menu323_Click()

  EcrM.Show()

End

Public Sub Button1_Click()

  Panel2.Visible = False

End

Public Sub Menu324_Click()

  Anomalies.Show()

End

Public Sub Menu325_Click()

  EdPrep.Show()

End

Public Sub Menu326_Click()

  Dim hForm As Commail

  hForm = New Commail("")
  hForm.Showmodal()
  Stop Event

End

Public Sub Menu327_Click()

  Ttourne.Show

End

Public Sub mvst_Click()

  Stockmvt.Show

End

Public Sub Menu328_Click()

  DocActif.Show()

End


Public Sub Menu330_Click()

  Dim dbl As DB_Log
  Dbl = New DB_Log(Utils.db)
  Dbl.Show()

End

Public Sub Menuimpfec_Click()

  impfec.Show

End

Public Sub MenuTbq_Click()

  Banque.Show

End

Public Sub MenuTrlcr_Click()

  Lcr.Show

End

Public Sub MenuAbq_Click()

  Attribution.Show

End

Public Sub Menuprep_Click()

  Preparation.Show

End

Public Sub MenuGbrd_Click()

  Bordrx.Show

End

Public Sub Menuis_Click()

  Glcr.Show

End
