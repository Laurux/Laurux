' Gambas class file

Create Static
Public Const Normal As Integer = 0
Public Const Disabled As Integer = 1
Public Const HasFocus As Integer = 2
Public Const Hovered As Integer = 4
Public Const Active As Integer = 8

Public Sub DrawButton(X As Integer, Y As Integer, Width As Integer, Height As Integer, Pressed As Boolean, Flag As Integer, Optional iColor As Integer = &HC6C6C6)
  
  Dim iWidth, iHeight As Integer
  Dim iColorOrder As Integer[]
  Dim C1, C2, C3, C4 As Integer
  Dim Cinfo As ColorInfo
  
  iColorOrder = IIf(Pressed, [1, 0], [0, 1])
  Cinfo = Color[iColor]
  iColor = Color.HSV(Cinfo.Hue, Cinfo.Saturation, 198)
  C1 = Color.HSV(Cinfo.Hue, Cinfo.Saturation, 127)
  C2 = Color.HSV(Cinfo.Hue, Cinfo.Saturation, 223)
  C3 = Color.HSV(Cinfo.Hue, Cinfo.Saturation, 191)
  C4 = Color.HSV(Cinfo.Hue, Cinfo.Saturation, 255)
  X += 2
  Y += 2
  iWidth = Width - 2 * 2
  iHeight = Height - 2 * 2
  
  'Paint.AntiAlias = False
  Paint.LineWidth = 1
  Paint.Brush = Paint.LinearGradient(X, Y, X, Y + iHeight, [iColor, C1], iColorOrder)
  Paint.Rectangle(X, Y, iWidth, iHeight, 3)
  Paint.Stroke
  Paint.Brush = Paint.Color(C4)
  Paint.Rectangle(X + 1, Y + 1, iWidth - 2, iHeight - 2, 3)
  Paint.Stroke(True)
  Paint.Brush = Paint.LinearGradient(X, Y, X, Y + iHeight, [C2, C3], iColorOrder)
  Paint.Fill
  Paint.LineWidth = 2
  
  If Flag = 2 Or If flag = 6 Then
    Paint.Brush = Paint.Color(Color.Lighter(Color.SelectedBackground))
    Paint.Rectangle(2, 2, Width - 4, Height - 4, 3)
    Paint.Stroke
  Endif
  
End
