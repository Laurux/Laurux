' Gambas class file

Inherits PdfWriter
R As Integer
G As Integer
B As Integer

Public Sub _new()
  
  R = Start.R
  G = Start.G
  B = Start.B
  
End

Public Sub _free()
  
End

Public Sub Entete(sEntete As String)
  
  Me.AddPage
  Me.SetXY(2, 5)
  Me.SetFont("Helvetica", "B", 16)
  Me.SetFillColor(R, G, B)
  Me.cell(206, 8, sEntete, True, 0, "C", True)
  
End

'Page footer
Public Function BasPage()
  
  Me.SetY(-10)
  Me.SetFont("Helvetica", "I", 8)
  Me.SetFillColor(R, G, B)
  Me.Cell(190, 6, "Page " & Me.PageNo() & "/{nb}" & " - " & Format$(Date(Now), "dd/mm/yyyy") & " - Impression demandée par " & User.Name, False, 0, "C", False)
  
End

Public Sub Level0(nom As String, dateedition As String, ste As String)
  
  Me.SetXY(2, 15)
  Me.SetFont("Helvetica", "B", 9)
  Me.cell(190, 8, ste & ".  " & nom & " " & dateedition, False, 0, "C", False)
  
End

'Entete des Lcr acceptées et non acceptées.
Public Sub Level1()
  
  Dim h As Integer = 8
  
  Me.SetXY(6, 24)
  Me.SetFont("Helvetica", "", 9)
  Me.SetFillColor(R, G, B)
  Me.cell(20, h, "N° facture", True, 0, "C", True)
  Me.cell(25, h, "Date facture", True, 0, "C", True)
  Me.cell(72, h, "Nom", True, 0, "C", True)
  Me.cell(25, h, "Date echeance.", True, 0, "C", True)
  Me.cell(25, h, "Montant", True, 0, "C", True)
  Me.cell(15, h, "Ecartée", True, 0, "C", True)
  Me.cell(15, h, "Code acpt", True, 0, "C", True)
  
End

'Ligne des Lcr 
Public Sub Level2(num As String, Datel As String, snom As String, sadr1 As String, sadr2 As String, scp As String, datech As String, smontant As String, secartee As String, sacceptee As String, PosY As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(6, posY)
  Me.SetFont("Helvetica",, 7)
  Me.cell(20, h, num, False, 0, "L", False)
  Me.cell(25, h, datel, False, 0, "C", False)
  Me.cell(72, h, snom, False, 0, "L", False)
  Me.cell(25, h, datech, False, 0, "C", False)
  Me.cell(23, h, Format$(Val(smontant), "0.00"), False, 0, "R", False)
  Me.cell(17, h, secartee, False, 0, "C", False)
  Me.cell(15, h, sacceptee, False, 0, "C", False)
  Me.SetXY(51, posY + 5)
  If Not IsNull(sadr1) Then
    Me.cell(72, h, sadr1, False, 0, "L", False)
    Me.SetXY(51, posY + 10)
  Endif
  If Not IsNull(sadr2) Then
    Me.cell(72, h, sadr2, False, 0, "L", False)
    Me.SetXY(51, posY + 15)
  Endif
  If Not IsNull(scp) Then
    Me.cell(72, h, scp, False, 0, "L", False)
  Endif
  
End

'Entete des Lcr attribuées.
Public Sub Level1A()
  
  Dim h As Integer = 8
  
  Me.SetXY(2, 24)
  Me.SetFont("Helvetica", "", 9)
  Me.SetFillColor(R, G, B)
  Me.cell(20, h, "N° facture", True, 0, "C", True)
  Me.cell(25, h, "Date facture", True, 0, "C", True)
  Me.cell(72, h, "Nom", True, 0, "C", True)
  Me.cell(24, h, "Date echeance", True, 0, "C", True)
  Me.cell(20, h, "Montant", True, 0, "C", True)
  Me.cell(15, h, "Ecartée", True, 0, "C", True)
  Me.cell(15, h, "Code acpt", True, 0, "C", True)
  Me.cell(15, h, "Banque", True, 0, "C", True)
  
End

'Ligne des Lcr 
Public Sub Level2A(num As String, Datel As String, snom As String, sadr1 As String, sadr2 As String, scp As String, datech As String, smontant As String, secartee As String, sacceptee As String, sbanque As String, PosY As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(2, posY)
  Me.SetFont("Helvetica",, 7)
  Me.cell(20, h, num, False, 0, "L", False)
  Me.cell(25, h, datel, False, 0, "C", False)
  Me.cell(72, h, snom, False, 0, "L", False)
  Me.cell(24, h, datech, False, 0, "C", False)
  Me.cell(20, h, Format$(Val(smontant), "0.00"), False, 0, "R", False)
  Me.cell(15, h, secartee, False, 0, "C", False)
  Me.cell(15, h, sacceptee, False, 0, "C", False)
  Me.cell(15, h, sbanque, False, 0, "C", False)
  Me.SetXY(47, posY + 5)
  If Not IsNull(sadr1) And If sadr1 <> " " Then
    Me.cell(72, h, sadr1, False, 0, "L", False)
    Me.SetXY(47, posY + 10)
  Endif
  If Not IsNull(sadr2) And If sadr2 <> " " Then
    Me.cell(72, h, sadr2, False, 0, "L", False)
    Me.SetXY(47, posY + 15)
  Endif
  If Not IsNull(scp) And If scp <> " " Then Me.cell(72, h, scp, False, 0, "L", False)
  
End

'Entete du Bordereaux
Public Sub Level1B(Resoc As String, Dom As String, Emetteur As String, Codbanque As String, Codeguichet As String, Numerocompte As String, Ref As String, Entree As String, Posy As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(2, posY)
  Me.SetFont("Helvetica",, 10)
  Me.cell(100, h, Resoc, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, Dom, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, "Emetteur : " & Emetteur, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, "Code banque : " & CodBanque, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, "Codeguichet : " & Codeguichet, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, "Numéro de compte : " & Numerocompte, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, Ref, False, 0, "L", False)
  Posy += 4
  Me.SetXY(2, posY)
  Me.cell(100, h, Entree, False, 0, "L", False)
  
End

Public Sub Level2B(Posy As Integer)
  
  Dim h As Integer = 10
  
  Me.SetXY(10, Posy)
  Me.SetFont("Helvetica", "", 10)
  Me.SetFillColor(R, G, B)
  Me.cell(20, h, "N° facture", True, 0, "C", True)
  Me.cell(25, h, "Date facture", True, 0, "C", True)
  Me.cell(98, h, "Nom", True, 0, "C", True)
  Me.cell(26, h, "Date echeance", True, 0, "C", True)
  Me.cell(20, h, "Montant", True, 0, "C", True)
  
End

'Lignes des LCR
Public Sub Level3B(snumfac As String, sdate As String, snom As String, sdatee As String, smontant As String, Posy As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(10, posY)
  Me.SetFont("Helvetica",, 10)
  Me.cell(20, h, snumfac, False, 0, "L", False)
  Me.cell(25, h, sdate, False, 0, "C", False)
  Me.cell(98, h, snom, False, 0, "L", False)
  Me.cell(25, h, sdatee, False, 0, "C", False)
  Me.cell(20, h, smontant, False, 0, "R", False)
  
End

'Bas du bordereau
Public Sub Level4B(Nbtraite As String, montant As String, Posy As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(2, posY)
  Me.SetFont("Helvetica",, 10)
  Me.cell(100, h, "Nombre traite(s) : " & Nbtraite, False, 0, "L", False)
  Me.SetXY(50, posY)
  Me.cell(100, h, "Montant : " & Format(Val(Utils.cpoint(montant)), "0.00"), False, 0, "L", False)
  PosY += 5
  Me.SetXY(2, posY)
  Me.cell(100, h, "Date de remise : " & Format$(Now, "dd.mm.yyyy"), False, 0, "L", False)
  
End

'Total lignes LCR
Public Sub Level5A(Nbtraite As String, montant As String, Posy As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(2, posY)
  Me.SetFont("Helvetica",, 10)
  Lines(PosY)
  PosY += 4
  Me.cell(100, h, "Nombre traite(s) : " & Nbtraite, False, 0, "L", False)
  Me.SetXY(50, posY)
  Me.cell(100, h, "Montant : " & Format(Val(Utils.cpoint(montant)), "0.00"), False, 0, "L", False)
  PosY += 4
  Lines(PosY)
  
End

'Lignes continues
Public Sub Lines(PosY As String)
  
  Me.SetXY(7, PosY)
  Me.SetLineWidth(0.1)
  Me.Line(2, PosY, 206, PosY)
  
End
